---
// src/components/NewsletterCTA.astro
export interface Props {
  title?: string;
  subtitle?: string;
  action?: string;        // Netlify Forms success URL (e.g., "/thanks/")
  note?: string;          // small print under the form
}

const {
  title = "Get updates on new brand stories",
  subtitle = "Short, occasional emails when we publish new timelines, datasets, and deep dives.",
  action = "/thanks/",
  note = "No spam. Unsubscribe anytime.",
} = Astro.props;
---

<section
  class="mt-8 rounded-2xl border border-slate-200 bg-white/70 p-5 shadow-sm dark:border-slate-800 dark:bg-slate-900/50"
  aria-label="Newsletter signup"
>
  <h2 class="text-xl font-semibold mb-1 text-slate-900 dark:text-slate-100">
    {title}
  </h2>
  <p class="text-slate-600 dark:text-slate-300 mb-4">
    {subtitle}
  </p>

  <!-- Netlify Forms-ready. Works even without JS. -->
  <form
    name="newsletter"
    method="POST"
    action={action}
    data-netlify="true"
    netlify-honeypot="bot-field"
    class="flex flex-col gap-3 sm:flex-row"
  >
    <!-- Netlify Forms required hidden input -->
    <input type="hidden" name="form-name" value="newsletter" />
    <!-- Honey pot -->
    <input type="text" name="bot-field" class="hidden" tabindex="-1" autocomplete="off" />

    <label class="sr-only" for="newsletter-email">Email address</label>
    <input
      id="newsletter-email"
      name="email"
      type="email"
      required
      autocomplete="email"
      placeholder="you@example.com"
      class="w-full flex-1 rounded-md border border-slate-300 bg-white px-3 py-2 text-slate-900 placeholder-slate-400 focus-ring dark:border-slate-700 dark:bg-slate-900 dark:text-slate-100"
    />

    <button
      type="submit"
      class="btn-primary focus-ring whitespace-nowrap"
      aria-label="Subscribe to newsletter"
    >
      Subscribe
    </button>
  </form>

  <p class="mt-2 text-xs text-slate-500 dark:text-slate-400">
    {note}
  </p>
</section>
