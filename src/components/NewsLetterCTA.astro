---
// src/components/NewsletterCTA.astro
// Props:
// - title?: string
// - subtitle?: string
// - buttonLabel?: string
// - disclaimer?: string
// - class?: string
//
// Netlify Forms compatible (no server needed):
//  - data-netlify="true"
//  - name="newsletter"
//  - honeypot "bot-field"

const {
  title = "Get new brand stories in your inbox",
  subtitle = "Short, researched timelines of discontinued brands. No spam—just the good stuff.",
  buttonLabel = "Subscribe",
  disclaimer = "By subscribing, you agree to our privacy policy. Unsubscribe anytime.",
  class: className = "",
} = Astro.props as {
  title?: string;
  subtitle?: string;
  buttonLabel?: string;
  disclaimer?: string;
  class?: string;
};
---

<section
  aria-label="Newsletter signup"
  class={`mt-8 rounded-2xl border border-slate-200 dark:border-slate-800 bg-gradient-to-br from-slate-50 to-white dark:from-slate-900 dark:to-slate-950 p-4 md:p-6 ${className}`}
>
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
    <div class="min-w-0">
      <h2 class="text-lg md:text-xl font-semibold">{title}</h2>
      <p class="text-slate-600 dark:text-slate-300 text-sm mt-1">{subtitle}</p>
    </div>

    <form
      method="POST"
      name="newsletter"
      data-netlify="true"
      netlify-honeypot="bot-field"
      class="flex w-full md:w-auto gap-2"
    >
      {/* Netlify hidden bits */}
      <input type="hidden" name="form-name" value="newsletter" />
      <p class="hidden">
        <label>
          Don’t fill this out if you’re human: <input name="bot-field" />
        </label>
      </p>

      <label class="sr-only" for="newsletter-email">Email address</label>
      <input
        id="newsletter-email"
        name="email"
        type="email"
        required
        inputmode="email"
        autocomplete="email"
        placeholder="you@example.com"
        class="flex-1 md:w-72 rounded-md border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100 px-3 py-2 focus-ring"
      />

      <button
        type="submit"
        class="btn-primary focus-ring px-4 py-2 rounded-md"
        aria-label="Subscribe to newsletter"
      >
        {buttonLabel}
      </button>
    </form>
  </div>

  <p class="text-xs text-slate-500 dark:text-slate-400 mt-3">{disclaimer}</p>
</section>
