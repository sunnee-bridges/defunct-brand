---
// src/components/ArticleHero.astro
export interface Props {
  title: string;
  description?: string;
  date?: string | Date;          // prefer this
  publishDate?: string | Date;   // legacy fallback
  image?: { src: string; alt?: string } | string;
  imageAlt?: string;             // if image is a string
}

const {
  title,
  description = "",
  date,
  publishDate,
  image,
  imageAlt = "",
} = Astro.props;

const rawDate = date ?? publishDate ?? null;
let iso = "";
let pretty = "";

if (rawDate) {
  const d = new Date(String(rawDate));
  if (!isNaN(d.getTime())) {
    iso = d.toISOString();
    pretty = d.toLocaleDateString(undefined, { year: "numeric", month: "long", day: "numeric" });
  }
}

function imgSrc(i: Props["image"]) {
  if (!i) return null;
  return typeof i === "string" ? i : i.src;
}
function imgAlt(i: Props["image"]) {
  if (!i) return "";
  return typeof i === "string" ? (imageAlt || "") : (i.alt || "");
}
---
<header class="mb-6">
  <h1 class="text-2xl md:text-3xl font-bold">{title}</h1>
  {description && <p class="text-slate-600 dark:text-slate-300 mt-1">{description}</p>}
  {pretty && (
    <time datetime={iso} class="block text-sm text-slate-500 dark:text-slate-400 mt-1">
      {pretty}
    </time>
  )}
  {imgSrc(image) && (
    <figure class="mt-4 overflow-hidden rounded-xl border border-slate-200 dark:border-slate-800">
      <img src={imgSrc(image)} alt={imgAlt(image)} class="w-full h-auto block" loading="lazy" />
    </figure>
  )}
</header>
